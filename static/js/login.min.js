const lA=ghB("password"),lB=ghB("new_password"),lC=ghB("show_password"),lD=ghB("show_new_password"),lE=ghB("submit_sign_up"),lF=ghB("file");var lG=!1;hF(lC,()=>{lA.type==="text"?lH(lA,lC):lI(lA,lC)});hF(lD,()=>{lB.type==="text"?lH(lB,lD):lI(lB,lD)});lF.on("change",async()=>{ghC(".file").html("<img alt='Dein Bild' src='"+await lF.getImgBase64()+"'>")});hF(ghB("submit_login"),lJ);hF(lE,lK);hF(ghA(".login_switch"),lL);hF(ghB("submit_recovery"),async A=>{hG(A);const B=ghB("recovery-mail"),C=ghB("recovery-code");if(hA(B)){return nD("Du musst deine E-Mail eingeben.")}if(!lG){return lM()}if(hA(C)){return nD("Bitte gib den Code ein, der dir per E-Mail geschickt wurde.")}const D=await post(a+"recoverySubmit",{email:B.val(),code:C.val()});if(D.status===200){g=h+"/login?exec=passwordSuccessfulReset";return}if(D.status===501){return nB(D.message)}nB("Etwas ist schief gelaufen...")});hF(ghB("password-forgotten"),A=>{hG(A);hC(ghA(".login"),"flex");hC(ghA(".password-recovery"),"flex")});hF(ghB("recovery_switch"),()=>{hC(ghA(".login"),"flex");hC(ghA(".password-recovery"),"flex")});function lH(A,B){A.type="password";B.src="/img/svg/eye.svg"}function lI(A,B){A.type="text";B.src="/img/svg/eye_closed.svg"}async function lJ(Z){hG(Z);const A=ghB("username"),B=ghB("redir").getAttribute("redirect").replaceAll("PAY_AND","&").replaceAll("PAY_QUESTION_MARK","?");if(hA(A)||hA(lA)){return nD("Bitte fülle alle Pflichtfelder aus.")}const C=await post(a+"login",{username:A.val(),password:lA.val()}).catch(D=>{console.error(D);nB(D.message);return{valid:!1}});if(C?.valid){g.href=C.type==="user"&&!B.includes("?")?B+"?exec=informUserIsNotMember":B;return}nB(C.message)}async function lK(A){hG(A);lE.disabled=!0;const B=ghB("new_username"),C=ghB("name"),D=ghB("family_name"),E=ghB("email"),F=ghB("phone"),G=ghB("address"),H=ghB("post_code"),I=ghB("city");if([B,C,D,E,lB,G,H,I].filter(hA).length>0){lE.disabled=!1;return nB("Bitte fülle alle Pflichtfelder aus.")}let J="ERROR";try{if(lF.files.length===0){throw new Error("Kein Bild ausgewählt.")}J=await gZ(lF.file())}catch(A){J="/img/svg/personal.svg"}if(J==="ERROR"){J="/img/svg/personal.svg"}const K=await post(a+"signUp",{username:B.val(),password:lB.val(),name:C.val(),family_name:D.val(),email:E.val(),address:`${G.val()}, ${H.val()} ${I.val()}`,picture:J,phone:hA(F)?"Keine Nummer":F.val()}).catch(A=>{console.error(A);nB(A.message);return{valid:!1}});if(K?.valid){g.href = ghB("redir").getAttribute("redirect");return}lE.disabled=!1;nB(K.message)}function lL(){hC(ghA(".login"),"flex");hC(ghA(".sign-up"),"flex")}async function lM(){const A=await post(a+"recoveryRequest",{email:ghB("recovery-mail").val()});if(A.status!==200){return nB(A.status===500?"Diese E-Mail ist nicht registriert.":"Etwas ist schief gelaufen...")}nF("Code gesendet!");lG=!0;hE(ghA(".recovery-hidden"),"invisible")}ghC(".h-t-b-m").remove();ghC(".h-n-b").remove();clearInterval(gN);removeEventListener("resize",gW)
